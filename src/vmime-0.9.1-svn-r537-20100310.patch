This file is part of mingw-cross-env.
See doc/index.html for further information.

diff -urN a/bootstrap b/bootstrap
--- a/bootstrap	2010-03-12 09:49:06.176332875 +0100
+++ b/bootstrap	2010-03-12 09:50:54.138458453 +0100
@@ -13,6 +13,13 @@
 (mkdir autotools >& /dev/null)
 (cd autotools && rm -f config.guess config.sub missing mkinstalldirs compile ltmain.sh depcomp install-sh)
 
+# Check for "glibtoolize" instead of "libtoolize" on OSX
+LIBTOOLIZE=libtoolize
+if which glibtoolize > /dev/null 2>&1; then
+	LIBTOOLIZE=glibtoolize
+fi
+
+
 DIE=0
 
 echo ""
@@ -36,7 +43,7 @@
 fi
 
 if test $DIE = 0 ; then
-	echo -n "* Running libtoolize... " ; (libtoolize --copy --force --automake >& bootstrap.tmpout) \
+	echo -n "* Running libtoolize... " ; ($LIBTOOLIZE --copy --force --automake >& bootstrap.tmpout) \
 		&& (echo "[OK]" ; cat bootstrap.tmpout ; rm -f bootstrap.tmpout) \
 		|| (echo "[NO]" ; cat bootstrap.tmpout ; rm -f bootstrap.tmpout ; not_a_command >& /dev/null) || DIE=1
 fi
diff -urN a/src/security/sasl/defaultSASLAuthenticator.cpp b/src/security/sasl/defaultSASLAuthenticator.cpp
--- a/src/security/sasl/defaultSASLAuthenticator.cpp	2010-03-12 09:48:28.343325021 +0100
+++ b/src/security/sasl/defaultSASLAuthenticator.cpp	2010-03-12 09:50:54.138458453 +0100
@@ -96,7 +96,7 @@
 
 const string defaultSASLAuthenticator::getServiceName() const
 {
-	return m_saslSession->getServiceName();
+	return m_saslSession.acquire()->getServiceName();
 }
 
 
@@ -121,7 +121,7 @@
 
 ref <SASLSession> defaultSASLAuthenticator::getSASLSession() const
 {
-	return m_saslSession;
+	return m_saslSession.acquire().constCast <SASLSession>();
 }
 
 
diff -urN a/vmime/security/sasl/defaultSASLAuthenticator.hpp b/vmime/security/sasl/defaultSASLAuthenticator.hpp
--- a/vmime/security/sasl/defaultSASLAuthenticator.hpp	2010-03-12 09:48:28.373325002 +0100
+++ b/vmime/security/sasl/defaultSASLAuthenticator.hpp	2010-03-12 09:50:54.138458453 +0100
@@ -67,10 +67,8 @@
 
 	defaultAuthenticator m_default;
 
-
 	weak_ref <net::service> m_service;
-
-	ref <SASLSession> m_saslSession;
+	weak_ref <SASLSession> m_saslSession;
 	ref <SASLMechanism> m_saslMech;
 };
 
