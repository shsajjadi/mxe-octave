# HG changeset patch
# User John Donoghue
# Date 1440511254 14400
#      Tue Aug 25 10:00:54 2015 -0400
# Node ID 6ccac6d363c9082ab3898e7220ca1b3e3bb09043
# Parent  1bbc3eb050ac4fcb6704e43ef11dc809c0a83e55
Use FLIB settings from mkoctfile in mingw build

* src/Makefile.in: set F77LIBS to mkoctfile values and use in link

diff -r 1bbc3eb050ac -r 6ccac6d363c9 src/Makefile.in
--- a/src/Makefile.in	Fri Aug 14 16:28:35 2015 -0600
+++ b/src/Makefile.in	Tue Aug 25 10:00:54 2015 -0400
@@ -1,9 +1,15 @@
 MKOCTFILE ?= mkoctfile -Wall
+OCTAVE_CONFIG ?= octave-config
 SED       ?= sed
 LIBS_F=source_f/libsla.a
 CXXFLAGS=@CXXFLAGS@
 FFLAGS=@AM_FFLAGS@ @FFLAGS@
 
+CANONICAL_HOST_TYPE=$(shell $(OCTAVE_CONFIG) -p CANONICAL_HOST_TYPE)
+ifneq (,$(findstring mingw,$(CANONICAL_HOST_TYPE)))
+  F77LIBS := $(shell $(MKOCTFILE) -p FLIBS)
+endif
+
 ## The next two are important to actually rebuild them when a change
 ## is made to the the functions they link to.
 OCT_LINK_F=__surrogates__.oct __c1__.oct __upo__.oct lazy.oct
@@ -73,7 +79,7 @@
 	$(MKOCTFILE) $(CXXFLAGS) $< $(LIBS) -o $@
 
 $(OCT_LINK_F): %.oct : %.cc $(OBJECTS_F) $(LIBS_F)
-	$(MKOCTFILE) $(CXXFLAGS) $< $(OBJECTS_F) $(LIBS_F) -o $@
+	$(MKOCTFILE) $(CXXFLAGS) $< $(OBJECTS_F) $(LIBS_F) $(F77LIBS) -o $@
 
 $(OCT_LINK_CC): %.oct : %.cc $(OBJECTS_CC)
 	$(MKOCTFILE) $(CXXFLAGS) $< $(OBJECTS_CC) -o $@
